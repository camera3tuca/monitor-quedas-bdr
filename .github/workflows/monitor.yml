name: Monitor de Quedas (2 em 2 horas)

on:
  schedule:
    # 13:30 UTC = 10:30 Brasil
    # Roda nos minutos 30 das horas 13, 15, 17 e 19
    - cron: '30 13,15,17,19 * * 1-5'
  workflow_dispatch: # Permite rodar manualmente se precisares

jobs:
  build:
    runs-on: ubuntu-latest
    env:
      WHATSAPP_PHONE: ${{ secrets.WHATSAPP_PHONE }}
      WHATSAPP_APIKEY: ${{ secrets.WHATSAPP_APIKEY }}
      BRAPI_API_TOKEN: ${{ secrets.BRAPI_API_TOKEN }}
      GITHUB_ACTIONS: "true"

    steps:
      - name: Baixar código
        uses: actions/checkout@v3

      - name: Configurar Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: Instalar dependências
        run: pip install -r requirements.txt

      - name: Rodar Monitor
        run: python app.py
